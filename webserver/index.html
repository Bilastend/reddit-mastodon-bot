<!DOCTYPE html>
<head>
    <title>Alt-Text</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/socket.io@4.5.4/client-dist/socket.io.min.js"></script>
</head>

<script>
    const host = window.location.hostname;
    const socket = io(`http://${host}:8080`);

    socket.on("connect", () => {
        socket.emit('update'); 
    });

    socket.on('change label', (data) => {
        let labelElement = document.getElementById("Alt-Text");
        labelElement.innerText = data;
    });

    function submitAlt() {
        let text = document.getElementById("Alt-Text-Input").value;
        socket.emit('set_alt_text', text); 
    }

    function reroll() {
        socket.emit('reroll');
    }
</script>

<!--TODO: Website layout look absolutely awful. Please change it (someday)-->
<body>
    <div class="container">
        <div class="image">
            <img src="/image.png" width="500px">
        </div>
        <div id="Alt-Text-Div">
            <span id="Alt-Text">Test</span>
        </div>
        <div class="Alt-Text-Input-Div">
            <textarea id="Alt-Text-Input"></textarea>
            <div>
                <span id="current">0</span>
                <span>/ 1500</span>
            </div>
            <div>
                <button onclick="submitAlt()">Submit</button>
                <button onclick="reroll()">Reroll post</button>
            </div>
        </div>
    </div>
</body>

<script>
    $('textarea').keyup(function() {
        var count = $(this).val().length,
            current = $('#current');
            current.text(count);
    });
</script>
</html>
